# SQL





##### 사원 테이블의 전체 목록을 출력

```SQL
SELECT * FROM EMP;
```

##### Line/Page size 변경

```SQL
set linesize 100; set pagesize 20;
```

##### Alias (별칭)

```sql
SELECT ENAME AS "별칭" FROM EMP;
```

##### 테이블 구조 확인

```sql
DESC {EMP}; 
DESCRIBE {EMP};
```

##### 문자열 연결

```sql
STRING || STRING
```

##### 사원 테이블의 모든 데이터를 출력

```sql
SELECT * FROM EMP;
```

##### 사원테이블에서 사원의 이름, 사원번호, 월급 출력

```sql
SELECT ENAME, EMPNO, SAL
FROM EMP;
```

##### 사원테이블에서 사원의 이름과 연봉을 출력

```sql
SELECT ENAME, SAL*12
FROM EMP;
```

##### 사원 테이블에서 사원의 이름, 입사일(HIREDATE), 부서번호(DEPTNO)를 출력하자

```SQL
SELECT ENAME, HIREDATE, DEPTNO
FROM EMP;
```

##### 사원 테이블에서 사원의 이름과, 해당 사원의 관리자(MGR)를 출력하자

```SQL
SELECT ENAME, MGR
FROM EMP;
```

##### 부서 테이블(DEPT)의 구조를 보자

```SQL
DESC DEPT;
```

##### 사원 테이블에서 사원의 이름, 월급, 커미션(COMM)을 출력하자

```SQL
SELECT ENAME, SAL, COMM
FROM EMP;
```

##### 사원 테이블의 모든 데이터를 “ㅇㅇ님이 ㅇㅇ에 입사를 하고 ㅇㅇ의 월급을 받습니다” 형식으로 출력하자

```SQL
SELECT ENAME || '님이 ' || HIREDATE || '에 입사를 하고 ' || SAL || '의 월급을 받습니다.' AS A
FROM EMP;
```

##### 사원 테이블에서 사원번호가 ‘7844’인 사원의 사원번호, 이름, 월급을 출력하자

```SQL
SELECT EMPNO, ENAME, SAL
FROM EMP
WHERE EMPNO = 7844;
```

##### 사원 테이블에서 ‘SMITH’의 사원번호, 이름, 월급을 출력하자

```SQL
SELECT EMPNO, ENAME, SAL
FROM EMP
WHERE ENAME = 'SMITH';
```

##### 사원 테이블에서 입사일이 1980년 12월 17일인 사원의 모든 데이터를 출력하자

```SQL
SELECT *
FROM EMP
WHERE HIREDATE = '1980/12/17';
```

##### 사원 테이블에서 1980년부터 1982년 사이에 입사한 사원의 이름과 입사일을 출력하자

```SQL
SELECT ENAME, HIRDATAE
FROM EMP
WHERE HIDRATE BTEWEEN '1980/01/01' AND '1982/12/31';
```

##### 월급이 2000 이하인 사원의 이름과 월급을 출력하자

```SQL
SELECT ENAME, SAL
FROM EMP
WHERE SAL <= 2000;
```

##### 사원번호가 7369, 7499, 7521인 사원들의 이름과 월급을 출력하자

```SQL
SELECT ENAME, SAL
FROM EMP
WHERE EMPNO IN (7369,7499,7521);
```



































#### 사원 테이블과 부서 테이블에서 사원들의 이름, 부서번호, 부서이름을 출력하자

```sql
SELECT E.ENAME, E.DEPTNO, D.DNAME
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO;
```

#### 사원 테이블과 부서 테이블에서 ‘DALLAS’ 에서 근무하는 사원의 이름, 직업, 부서번호, 부서이름을 출력하자

```sql
SELECT E.ENAME, E.JOB, E.DEPTNO, D.DNAME
FROM EMP E INNER JOIN DEPT D
ON E.DEPTNO = D.DEPTNO
WHERE D.LOC = 'DALLAS';

```

#### 사원 테이블과 부서 테이블에서 이름에 ‘A’ 가 들어가는 사원들의 이름과 부서이름을 출력하자
```sql
SELECT E.ENAME, D.DNAME
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
AND E.ENAME LIKE '%A%';

```

#### 사원 테이블과 부서 테이블에서 사원의 이름과 부서의 이름, 월급을 출력하자 (월급이 3000 이산인 사원들만 출력하자)
```sql
SELECT E.ENAME, D.DNAME, E.SAL
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
AND E.SAL >= 3000;
```

#### 사원 테이블과 부서 테이블에서 직업이 ‘SALESMAN’인 사원들의 직업과 사원 이름, 부서이름을 출력하자
```sql
SELECT E.JOB, E.ENAME, D.DNAME
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
AND E.JOB = 'SALESMAN';
```

#### 사원 테이블과 급여 테이블(SALGRADE)에서 커미션이 책정된 사원들의 사원번호, 이름, 연봉, 연봉+커미션, 급여등급(GRADE)을 출력하자
(각각의 컬럼명을 ‘사원번호’, ‘사원이름’, ‘연봉’, ‘연봉2’, ‘급여등급’으로)
```sql
SELECT E.EMPNO 사원번호, E.ENAME 사원이름, E.SAL*12 연봉,(E.SAL * 12) + E.COMM 연봉2, S.GRADE S
FROM EMP E, SALGRADE S
WHERE E.SAL BETWEEN S.LOSAL AND S.HISAL
AND E.COMM > 0;
```

#### 사원 테이블과 부서 테이블, 급여 테이블에서 부서번호가 10번인 사원들의 부서번호, 부서이름, 사원이름, 월급, 급여등급을 출력하자
(부서번호가 낮은 순으로, 월급이 높은 순으로 출력하자)
```sql
SELECT D.DEPTNO, D.DNAME, E.ENAME, E.SAL, S.GRADE
FROM EMP E, DEPT D, SALGRADE S
WHERE E.DEPTNO = D.DEPTNO
AND E.SAL BETWEEN S.LOSAL AND S.HISAL
AND E.DEPTNO = 10
ORDER BY E.DEPTNO ASC, E.SAL DESC;

SELECT D.DEPTNO, D.DNAME, E.ENAME, E.SAL, S.GRADE
FROM EMP E 
INNER JOIN DEPT D ON (E.DEPTNO = D.DEPTNO)
INNER JOIN SALGRADE S ON (E.SAL >= S.LOSAL AND E.SAL <= S. HISAL)
WHERE D.DEPTNO = 10
ORDER BY E.DEPTNO ASC, E.SAL DESC;
```

#### 사원 테이블에서 사원번호와 사원이름, 관리자의 사원번호, 사원 이름을 출력하자
(각각의 컬럼명을 ‘사원번호’, ‘사원이름’, ‘관리자번호’, ‘관리자이름’으로)

```sql
SELECT E.EMPNO 사원번호, E.ENAME 사원이름, M.MGR 관리자번호, M.ENAME 관리자이름
FROM EMP E, EMP M
WHERE E.MGR = M.EMPNO;


SELECT
FROM E.

```

#### 사원 테이블과 부서 테이블에서 해당 부서의 모든 사원에 대한 부서이름, 위치, 사원수 및 평균 급여를 출력하자

```sql
SELECT DNAME, LOC, COUNT(*), AVG(SAL) 
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
GROUP BY DNAME, LOC;


SELECT DNAME, LOC, COUNT(*), AVG(SAL) 
FROM EMP JOIN DEPT USING(DEPTNO)
GROUP BY DNAME, LOC;

```



----



##### 관리자가 존재하는 부서의 / 장소 중 가장 많은 / 장소의 도시 이름을 출력하자 (ROWNUM 사용)

```SQL
SELECT ROWNUM, A.CITY 
FROM
	(SELECT A.LOCATION_ID, B.CITY, COUNT(A.MANAGER_ID) CNT 
	FROM DEPARTMENTS A, LOCATIONS B 
	WHERE A.LOCATION_ID = B.LOCATION_ID 
	AND A.MANAGER_ID IS NOT NULL 
	GROUP BY A.LOCATION_ID, B.CITY 
	ORDER BY CNT DESC) A
WHERE ROWNUM = '1'


SELECT CITY, CNT, ROWNUM
FROM
	(SELECT CITY, COUNT(*) AS CNT
	FROM DEPARTMENTS JOIN LOCATIONS USING(LOCATION_ID)
	WHERE DEPARTMENT_ID IN
		(SELECT DEPARTMENT_ID
		FROM DEPARTMENTS
		WHERE MANAGER_ID IS NOT NULL)
	GROUP BY CITY
	ORDER BY 2 DESC)
WHERE ROWNUM = 1;

```



##### 18년도가 근속 10주년인 사원의 이름과 입사일을 출력하자

```SQL
SELECT FIRST_NAME, HIRE_DATE 
FROM EMPLOYEES
WHERE TO_CHAR(HIRE_DATE, 'YYYY') = '2008';

SELECT FIRST_NAME, HIRE_DATE
FROM EMPLOYEES
WHERE HIRE_DATE BETWEEN '08/01/01' AND '08/12/31';

SELECT FIRST_NAME, HIRE_DATE
FROM EMPLOYEES
WHERE SUBSTR(ADD_MONTHS(HIRE_DATE, 120), 1, 2) = 18;
```



##### 사원 이름이 'S'로 시작하는 사원의 이름과 사원번호, 전화번호를 출력하자

```sql
SELECT FIRST_NAME || ' ' || LAST_NAME AS FULL_NAME, EMPLOYEE_ID, PHONE_NUMBER
FROM EMPLOYEES
WHERE LAST_NAME LIKE 'S%';
```



##### 입사년도가 04년 이후인 사원들중 Seattle 에서 근무중인 사원들의 월급 총 합을 출력하자

```sql
SELECT SUM(SALARY)
FROM EMPLOYEES E JOIN DEPARTMENTS D
ON (E.DEPARTMENT_ID = D.DEPARTMENT_ID)
JOIN LOCATIONS L
ON (D.LOCATION_ID = L.LOCATION_ID)
WHERE TO_CHAR(HIRE_DATE, 'YYYY') > '2004'
AND CITY = 'Seattle';

SELECT SUM(SALARY)
FROM EMPLOYEES JOIN DEPARTMENTS USING (DEPARTMENT_ID)
JOIN LOCATIONS USING(LOCATION_ID)
WHERE HIRE_DATE > '03/12/31'
AND CITY = 'Seattle';
```

##### 전체 평균 월급보다 월급을 많이 받는 사원들 중 9월에 입사한 사원들의 이름과 월급을 출력하자

```sql
SELECT FIRST_NAME, SALARY 
FROM EMPLOYEES 
WHERE SALARY > (SELECT AVG(SALARY) FROM EMPLOYEES) 
AND TO_CHAR(HIRE_DATE,'MM') = '09';
```

##### LAST_NAME 의 세번째 글자가 c인 사원들의 풀네임을 출력하자

```sql
SELECT LAST_NAME || ' ' || FIRST_NAME AS FULL_NAME
FROM EMPLOYEES
WHERE 'c' = SUBSTR(LAST_NAME, 3, 1);

SELECT LAST_NAME || ' ' || FIRST_NAME AS FULL_NAME
FROM EMPLOYEES
WHERE LAST_NAME LIKE '__c%';
```

##### 부서 번호가 없는 사원의 이름(FIRST_NAME)과 직업(JOB_ID) 입사날(HIRE_DATE)을 출력하자

```sql
SELECT FIRST_NAME, JOB_ID, HIRE_DATE
FROM EMPLOYEES
WHERE DEPARTMENT_ID IS NULL;
```

##### Kevin보다 월급을 많이 받고 Susan 보다 적게 받는 사원의 이름과 월급을 출력하자

```sql
SELECT FIRST_NAME, SALARY
FROM EMPLOYEES
WHERE SALARY > ALL(SELECT SALARY FROM EMPLOYEES WHERE FIRST_NAME='Kevin')
AND SALARY < (SELECT SALARY FROM EMPLOYEES WHERE FIRST_NAME='Susan');
```

##### Asia에 속해있는 도시이름과 나라 이름을 출력하자

```sql
SELECT CITY, COUNTRY_NAME
FROM LOCATIONS JOIN COUNTRIES USING (COUNTRY_ID)
JOIN REGIONS USING (REGION_ID)
WHERE REGION_NAME = 'Asia';


```

##### 월급이 4000이상인 사원의 이름과 부서명, 월급을 출력하자

```sql
SELECT FIRST_NAME, DEPARTMENT_NAME, SALARY
FROM EMPLOYEES E, DEPARTMENTS D
WHERE SALARY >= 4000
AND E.DEPARTMENT_ID = D.DEPARTMENT_ID;

SELECT FIRST_NAME, DEPARTMENT_NAME, SALARY
FROM EMPLOYEES LEFT OUTER JOIN DEPARTMENTS USING (DEPARTMENT_ID)
WHERE SALARY >= 4000
```

##### 부서의 평균월급이 전체 평균월급보다 높은 부서의 부서이름과 평균월급을 출력하자

```sql
SELECT *
FROM (SELECT DEPARTMENT_ID, AVG(SALARY) AVG_SAL 
      FROM EMPLOYEES 
      GROUP BY DEPARTMENT_ID)
WHERE AVG_SAL > (SELECT AVG(SALARY) FROM EMPLOYEES);

SELECT DEPARTMENT_NAME, AVG(SALARY)
FROM EMPLOYEES JOIN DEPARTMENTS USING(DEPARTMENT_ID)
GROUP BY DEPARTMENT_NAME
HAVING AVG(SALARY) > (SELECT AVG(SALARY) FROM EMPLOYEES);

```

##### 월급을 가장 많이 받는 사원의 전화번호를 출력하자

```sql
SELECT PHONE_NUMBER
FROM EMPLOYEES
WHERE SALARY = (SELECT MAX(SALARY) FROM EMPLOYEES);

SELECT PHONE_NUMBER 
FROM EMPLOYEES 
WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEES WHERE SALARY = (SELECT MAX(SALARY) FROM EMPLOYEES))

```

##### Seattle 에 근무하는 사원중 이름이 'l' (엘)로 끝나는 사원의 이름과 직업을 출력하자

```sql
SELECT FIRST_NAME, JOB_TITLE
FROM EMPLOYEES E, LOCATIONS L, JOBS J, DEPARTMENTS D
WHERE CITY = 'Seattle'
AND FIRST_NAME LIKE '%l'
AND E.JOB_ID = J.JOB_ID
AND E.DEPARTMENT_ID = D.DEPARTMENT_ID
AND D.LOCATION_ID = L.LOCATION_ID;

SELECT FIRST_NAME, JOB_ID FROM EMPLOYEES WHERE DEPARTMENT_ID IN (SELECT DEPARTMENT_ID FROM DEPARTMENTS WHERE LOCATION_ID IN (SELECT LOCATION_ID FROM LOCATIONS WHERE CITY = 'Seattle'))
AND FIRST_NAME LIKE '%l'

SELECT FIRST_NAME, JOB_ID
FROM EMPLOYEES JOIN DEPARTMENTS USING (DEPARTMENT_ID)
JOIN LOCATIONS USING (LOCATION_ID)
WHERE CITY = 'Seattle'
AND FIRST_NAME LIKE '%l';
```

##### 입사한 년도(hire_date)별로 인원수를 출력하자

```sql
SELECT YEAR, COUNT(*)
FROM (SELECT TO_CHAR(HIRE_DATE, 'YYYY') YEAR 
	FROM EMPLOYEES)
group by year
order by year;

SELECT SUBSTR(HIRE_DATE,1, 2), COUNT(*)
FROM EMPLOYEES
GROUP BY SUBSTR(HIRE_DATE, 1, 2)
order by SUBSTR(HIRE_DATE, 1, 2);
```

##### 캐나다에서 일하는 직원의 수를 출력하자

```sql
SELECT COUNT(*)
FROM EMPLOYEES JOIN DEPARTMENTS USING (DEPARTMENT_ID)
JOIN LOCATIONS USING (LOCATION_ID)
JOIN COUNTRIES USING (COUNTRY_ID)
WHERE COUNTRY_NAME = 'Canada';
```

##### 입사 후 직업의 변경이 없는 사원의 사원 번호, 이름, 입사일, 월급, 부서 이름을 출력하자

```sql
SELECT EMPLOYEE_ID, FIRST_NAME, HIRE_DATE, SALARY, DEPARTMENT_ID 
FROM EMPLOYEES 
WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID 
			FROM 
				(SELECT EMPLOYEE_ID, COUNT(JOB_ID) 
				FROM JOB_HISTORY 
				GROUP BY EMPLOYEE_ID 
				HAVING COUNT(JOB_ID) = 1)
			);
			
			
SELECT EMPLOYEE_ID, FIRST_NAME, HIRE_DATE, SALARY,DEPARTMENT_NAME
FROM EMPLOYEES LEFT OUTER JOIN DEPARTMENTS USING (DEPARTMENT_ID)
WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM JOB_HISTORY);
```

##### 각 부서 별 커미션이 책정되지 않은 사원의 수를 출력하자

```sql
SELECT DEPARTMENT_ID, COUNT(*)
FROM EMPLOYEES
WHERE COMMISSION_PCT IS NULL
GROUP BY DEPARTMENT_ID;
```

##### 핸드폰 번호가 011 로 시작하는 사원의 이름, 전화번호, 이메일을 출력하자

```sql
SELECT FIRST_NAME, PHONE_NUMBER, EMAIL
FROM EMPLOYEES
WHERE PHONE_NUMBER LIKE '011%';
```

##### 이름이 Britney 인 사원과 같은 부서에서 일하면서, Britney와 직업(JOB_ID)도 같은 사원의 모든 것을 출력하라.

```sql
SELECT * 
FROM EMPLOYEES 
WHERE 
DEPARTMENT_ID IN (SELECT DEPARTMENT_ID FROM EMPLOYEES WHERE FIRST_NAME = 'Britney')
AND
JOB_ID IN (SELECT JOB_ID FROM EMPLOYEES WHERE FIRST_NAME = 'Britney')


SELECT *
FROM EMPLOYEES 
WHERE (DEPARTMENT_ID,JOB_ID) IN (SELECT DEPARTMENT_ID,JOB_ID FROM EMPLOYEES WHERE FIRST_NAME = 'Britney')
```

  

##### IT 부서의 관리자의 연봉(commission_pct 생각하기) 보다 더 많은 평균 월급을 받는 부서의 부서번호와 부서이름을 출력하자

```sql
SELECT DEPARTMENT_ID, DEPARTMENT_NAME, AVG(SALARY)
FROM EMPLOYEES JOIN DEPARTMENTS USING (DEPARTMENT_ID)
GROUP BY DEPARTMENT_ID, DEPARTMENT_NAME
HAVING AVG(SALARY) >
	(SELECT SALARY * 12 * (1 + NVL(COMMISSION_PCT, 0))
	FROM EMPLOYEES
	WHERE EMPLOYEE_ID =
		(SELECT MANAGER_ID
		FROM DEPARTMENTS
		WHERE DEPARTMENT_NAME = 'IT'));

```

  
